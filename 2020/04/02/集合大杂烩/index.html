<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>集合大杂烩 | XiaoMing's Blog</title><meta name="description" content="集合大杂烩"><meta name="keywords" content="Java,集合"><meta name="author" content="XiaoMing"><meta name="copyright" content="XiaoMing"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta name="twitter:card" content="summary"><meta name="twitter:title" content="集合大杂烩"><meta name="twitter:description" content="集合大杂烩"><meta name="twitter:image" content="https://i.loli.net/2020/03/15/Jbq5kQYoRwiAjp7.jpg"><meta property="og:type" content="article"><meta property="og:title" content="集合大杂烩"><meta property="og:url" content="https://xiaoming0929.github.io/2020/04/02/%E9%9B%86%E5%90%88%E5%A4%A7%E6%9D%82%E7%83%A9/"><meta property="og:site_name" content="XiaoMing's Blog"><meta property="og:description" content="集合大杂烩"><meta property="og:image" content="https://i.loli.net/2020/03/15/Jbq5kQYoRwiAjp7.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://xiaoming0929.github.io/2020/04/02/%E9%9B%86%E5%90%88%E5%A4%A7%E6%9D%82%E7%83%A9/"><link rel="prev" title="数据库连接池C3P0连接池(mysql)" href="https://xiaoming0929.github.io/2020/04/02/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0C3P0%E8%BF%9E%E6%8E%A5%E6%B1%A0-mysql/"><link rel="next" title="SSM-Shiro的简单使用" href="https://xiaoming0929.github.io/2020/04/02/SSM-Shiro%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://XiaoMing0929.github.io","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: XiaoMing","link":"链接: https://xiaoming0929.github.io/2020/04/02/%E9%9B%86%E5%90%88%E5%A4%A7%E6%9D%82%E7%83%A9/","source":"来源: XiaoMing's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">XiaoMing's Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">20</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">33</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">13</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fa fa-picture-o"></i><span> 照片</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Collection"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Collection</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-List"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">1 List</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-ArrayList"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">1.1 ArrayList</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-1-类说明"><span class="toc_mobile_items-number">1.1.1.1.</span> <span class="toc_mobile_items-text">1.1.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-1-内部结构"><span class="toc_mobile_items-number">1.1.1.2.</span> <span class="toc_mobile_items-text">1.1.1 内部结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-1-1-1-初始化"><span class="toc_mobile_items-number">1.1.1.2.1.</span> <span class="toc_mobile_items-text">1.1.1.1 初始化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-1-1-2-扩容"><span class="toc_mobile_items-number">1.1.1.2.2.</span> <span class="toc_mobile_items-text">1.1.1.2 扩容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-1-1-3-删除元素"><span class="toc_mobile_items-number">1.1.1.2.3.</span> <span class="toc_mobile_items-text">1.1.1.3 删除元素</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-1-1-4-copyOf-和arraycopy"><span class="toc_mobile_items-number">1.1.1.2.4.</span> <span class="toc_mobile_items-text">1.1.1.4 copyOf()和arraycopy()</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-Vector"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">1.2 Vector</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-1-类说明"><span class="toc_mobile_items-number">1.1.2.1.</span> <span class="toc_mobile_items-text">1.2.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-2-内部结构"><span class="toc_mobile_items-number">1.1.2.2.</span> <span class="toc_mobile_items-text">1.2.2 内部结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-2-2-1-初始化"><span class="toc_mobile_items-number">1.1.2.2.1.</span> <span class="toc_mobile_items-text">1.2.2.1 初始化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-2-2-2-扩容"><span class="toc_mobile_items-number">1.1.2.2.2.</span> <span class="toc_mobile_items-text">1.2.2.2 扩容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-2-2-3-删除元素"><span class="toc_mobile_items-number">1.1.2.2.3.</span> <span class="toc_mobile_items-text">1.2.2.3 删除元素</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-LinkedList"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">1.3 LinkedList</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-3-1-类说明"><span class="toc_mobile_items-number">1.1.3.1.</span> <span class="toc_mobile_items-text">1.3.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-3-2-内部结构"><span class="toc_mobile_items-number">1.1.3.2.</span> <span class="toc_mobile_items-text">1.3.2 内部结构</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-Set"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">2 Set</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-HashSet"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">2.1 HashSet</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-1-1-类说明"><span class="toc_mobile_items-number">1.2.1.1.</span> <span class="toc_mobile_items-text">2.1.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-1-2-内部结构"><span class="toc_mobile_items-number">1.2.1.2.</span> <span class="toc_mobile_items-text">2.1.2 内部结构</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-LinkedHashSet"><span class="toc_mobile_items-number">1.2.2.</span> <span class="toc_mobile_items-text">2.2 LinkedHashSet</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-1-类说明"><span class="toc_mobile_items-number">1.2.2.1.</span> <span class="toc_mobile_items-text">2.2.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-2-内部结构"><span class="toc_mobile_items-number">1.2.2.2.</span> <span class="toc_mobile_items-text">2.2.2 内部结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#2-2-2-1-初始化"><span class="toc_mobile_items-number">1.2.2.2.1.</span> <span class="toc_mobile_items-text">2.2.2.1 初始化</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3-TreeSet"><span class="toc_mobile_items-number">1.2.3.</span> <span class="toc_mobile_items-text">2.3 TreeSet</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-1-类说明"><span class="toc_mobile_items-number">1.2.3.1.</span> <span class="toc_mobile_items-text">2.3.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-2-内部结构"><span class="toc_mobile_items-number">1.2.3.2.</span> <span class="toc_mobile_items-text">2.3.2 内部结构</span></a></li></ol></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Map"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Map</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-HashMap"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">1 HashMap</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-类说明"><span class="toc_mobile_items-number">2.1.1.</span> <span class="toc_mobile_items-text">1.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-内部结构："><span class="toc_mobile_items-number">2.1.2.</span> <span class="toc_mobile_items-text">1.2 内部结构：</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-1-初始化"><span class="toc_mobile_items-number">2.1.2.1.</span> <span class="toc_mobile_items-text">1.2.1 初始化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-2-hash-的变化"><span class="toc_mobile_items-number">2.1.2.2.</span> <span class="toc_mobile_items-text">1.2.2 hash()的变化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-3-存储结构"><span class="toc_mobile_items-number">2.1.2.3.</span> <span class="toc_mobile_items-text">1.2.3 存储结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-4-put-方法"><span class="toc_mobile_items-number">2.1.2.4.</span> <span class="toc_mobile_items-text">1.2.4 put()方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-5-get-方法"><span class="toc_mobile_items-number">2.1.2.5.</span> <span class="toc_mobile_items-text">1.2.5 get()方法</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-Hashtable"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">2 Hashtable</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-类说明"><span class="toc_mobile_items-number">2.2.1.</span> <span class="toc_mobile_items-text">2.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-内部结构"><span class="toc_mobile_items-number">2.2.2.</span> <span class="toc_mobile_items-text">2.2 内部结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-1-初始化"><span class="toc_mobile_items-number">2.2.2.1.</span> <span class="toc_mobile_items-text">2.2.1 初始化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-2-存储结构"><span class="toc_mobile_items-number">2.2.2.2.</span> <span class="toc_mobile_items-text">2.2.2 存储结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-3-put-方法"><span class="toc_mobile_items-number">2.2.2.3.</span> <span class="toc_mobile_items-text">2.2.3 put()方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-4-get-方法"><span class="toc_mobile_items-number">2.2.2.4.</span> <span class="toc_mobile_items-text">2.2.4 get()方法</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-LinkedHashMap"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">3 LinkedHashMap</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-1-类说明"><span class="toc_mobile_items-number">2.3.1.</span> <span class="toc_mobile_items-text">3.1 类说明</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-2-内部结构"><span class="toc_mobile_items-number">2.3.2.</span> <span class="toc_mobile_items-text">3.2 内部结构</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-1-初始化"><span class="toc_mobile_items-number">2.3.2.1.</span> <span class="toc_mobile_items-text">3.2.1 初始化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-2-存储结构："><span class="toc_mobile_items-number">2.3.2.2.</span> <span class="toc_mobile_items-text">3.2.2 存储结构：</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-3-put-方法"><span class="toc_mobile_items-number">2.3.2.3.</span> <span class="toc_mobile_items-text">3.2.3 put()方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-4-get-方法"><span class="toc_mobile_items-number">2.3.2.4.</span> <span class="toc_mobile_items-text">3.2.4 get()方法</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-TreeMap"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">4 TreeMap</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-1-类结构"><span class="toc_mobile_items-number">2.4.1.</span> <span class="toc_mobile_items-text">4.1 类结构</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-2-内部结构"><span class="toc_mobile_items-number">2.4.2.</span> <span class="toc_mobile_items-text">4.2 内部结构</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Collection"><span class="toc-number">1.</span> <span class="toc-text">Collection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-List"><span class="toc-number">1.1.</span> <span class="toc-text">1 List</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-ArrayList"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 ArrayList</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-类说明"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">1.1.1 类说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-内部结构"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">1.1.1 内部结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-1-初始化"><span class="toc-number">1.1.1.2.1.</span> <span class="toc-text">1.1.1.1 初始化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-2-扩容"><span class="toc-number">1.1.1.2.2.</span> <span class="toc-text">1.1.1.2 扩容</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-3-删除元素"><span class="toc-number">1.1.1.2.3.</span> <span class="toc-text">1.1.1.3 删除元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-4-copyOf-和arraycopy"><span class="toc-number">1.1.1.2.4.</span> <span class="toc-text">1.1.1.4 copyOf()和arraycopy()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Vector"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 Vector</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-类说明"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">1.2.1 类说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-内部结构"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">1.2.2 内部结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-2-1-初始化"><span class="toc-number">1.1.2.2.1.</span> <span class="toc-text">1.2.2.1 初始化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-2-2-扩容"><span class="toc-number">1.1.2.2.2.</span> <span class="toc-text">1.2.2.2 扩容</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-2-3-删除元素"><span class="toc-number">1.1.2.2.3.</span> <span class="toc-text">1.2.2.3 删除元素</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-LinkedList"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 LinkedList</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-类说明"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">1.3.1 类说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2-内部结构"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">1.3.2 内部结构</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Set"><span class="toc-number">1.2.</span> <span class="toc-text">2 Set</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-HashSet"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 HashSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-类说明"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">2.1.1 类说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-内部结构"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">2.1.2 内部结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-LinkedHashSet"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 LinkedHashSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-类说明"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">2.2.1 类说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-内部结构"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.2.2 内部结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-1-初始化"><span class="toc-number">1.2.2.2.1.</span> <span class="toc-text">2.2.2.1 初始化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-TreeSet"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 TreeSet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-类说明"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">2.3.1 类说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-内部结构"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2.3.2 内部结构</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Map"><span class="toc-number">2.</span> <span class="toc-text">Map</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-HashMap"><span class="toc-number">2.1.</span> <span class="toc-text">1 HashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-类说明"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1 类说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-内部结构："><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2 内部结构：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-初始化"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">1.2.1 初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-hash-的变化"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">1.2.2 hash()的变化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-3-存储结构"><span class="toc-number">2.1.2.3.</span> <span class="toc-text">1.2.3 存储结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-4-put-方法"><span class="toc-number">2.1.2.4.</span> <span class="toc-text">1.2.4 put()方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-5-get-方法"><span class="toc-number">2.1.2.5.</span> <span class="toc-text">1.2.5 get()方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Hashtable"><span class="toc-number">2.2.</span> <span class="toc-text">2 Hashtable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-类说明"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1 类说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-内部结构"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2 内部结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-初始化"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">2.2.1 初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-存储结构"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">2.2.2 存储结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-put-方法"><span class="toc-number">2.2.2.3.</span> <span class="toc-text">2.2.3 put()方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-4-get-方法"><span class="toc-number">2.2.2.4.</span> <span class="toc-text">2.2.4 get()方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-LinkedHashMap"><span class="toc-number">2.3.</span> <span class="toc-text">3 LinkedHashMap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-类说明"><span class="toc-number">2.3.1.</span> <span class="toc-text">3.1 类说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-内部结构"><span class="toc-number">2.3.2.</span> <span class="toc-text">3.2 内部结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-初始化"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">3.2.1 初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-存储结构："><span class="toc-number">2.3.2.2.</span> <span class="toc-text">3.2.2 存储结构：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-put-方法"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">3.2.3 put()方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-get-方法"><span class="toc-number">2.3.2.4.</span> <span class="toc-text">3.2.4 get()方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-TreeMap"><span class="toc-number">2.4.</span> <span class="toc-text">4 TreeMap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-类结构"><span class="toc-number">2.4.1.</span> <span class="toc-text">4.1 类结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-内部结构"><span class="toc-number">2.4.2.</span> <span class="toc-text">4.2 内部结构</span></a></li></ol></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2020/03/15/Jbq5kQYoRwiAjp7.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">集合大杂烩</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-04-02<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-04-02</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">5.8k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 24 分钟</span><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><html><head></head><body><ul>
<li>本篇博客内容主要是集合内容的介绍，包括：</li>
<li>Collection下的List,Set相关的集合</li>
<li>Map的相关集合</li>
<li>关于TreeSet和TreeMap内部实现(红黑树)的部分有时间再补上。</li>
<li>整理不易，可累死仙鱼我了，看完有收获的话记得点赞欧~</li>
</ul>
<h1 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h1><h2 id="1-List"><a href="#1-List" class="headerlink" title="1 List"></a>1 List</h2><h3 id="1-1-ArrayList"><a href="#1-1-ArrayList" class="headerlink" title="1.1 ArrayList"></a>1.1 ArrayList</h3><h4 id="1-1-1-类说明"><a href="#1-1-1-类说明" class="headerlink" title="1.1.1 类说明"></a>1.1.1 类说明</h4><ul>
<li><p><code>ArrayList</code>是继承<code>AbstractList</code>抽象类，实现<code>List</code>，<code>RandomAccess</code>，<code>Cloneable</code>，<code>lava.io.Serializable</code>接口的数组队列，相当于动态数组，容量可以动态增长，地址空间连续。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span><<span class="title">E</span>> <span class="keyword">extends</span> <span class="title">AbstractList</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">List</span><<span class="title">E</span>>, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>实现<code>RandomAccess</code>接口使ArrayList支持<code>快速随机访问查询</code>。</p>
<p>如下，RandomAccess接口中是没有任何实现的(Cloneable，Serializable也是)，就相当于给ArrayList做了一个可以快速随机访问的标识，因为ArrayList的底层实现是Object数组才支持快速随机访问。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RandomAccess</span> </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>ArrayList<code>不是线程安全的</code>，建议在单线程中使用，多线程情况下可以选择使用Vector(这个都快弃用了)或者CopyOnWirteArrayList。</p>
</li>
</ul>
<h4 id="1-1-1-内部结构"><a href="#1-1-1-内部结构" class="headerlink" title="1.1.1 内部结构"></a>1.1.1 内部结构</h4><h5 id="1-1-1-1-初始化"><a href="#1-1-1-1-初始化" class="headerlink" title="1.1.1.1 初始化"></a>1.1.1.1 初始化</h5><ul>
<li><p><code>初始化(构造时)，默认的数组初始化容量大小为10</code>：</p>
<p>调用无参的构造方法进行只是进行了数组的初始化，这个时候并没有分配容量，当添加第一个元素，调用add(E e)方法时，会初始化数组容量大小为10；</p>
<p><a href="https://img-blog.csdnimg.cn/20190718210126787.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190718210126787.png" class="lazyload"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}; <span class="comment">//0</span></span><br><span class="line"><span class="comment">// Object数组</span></span><br><span class="line"><span class="keyword">transient</span> Object[] elementData;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ArrayList</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;</span><br><span class="line">}</span><br><span class="line"><span class="comment">/***************************************************************************************************/</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_CAPACITY = <span class="number">10</span>; <span class="comment">//10</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> size;</span><br><span class="line"><span class="comment">// 将指定元素追加到此列表的末尾</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>{</span><br><span class="line">    ensureCapacityInternal(size + <span class="number">1</span>);  <span class="comment">// Increments modCount!!</span></span><br><span class="line">    elementData[size++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 得到最小扩容量</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityInternal</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateCapacity</span><span class="params">(Object[] elementData, <span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {</span><br><span class="line">        <span class="comment">//小于10则返回默认容量</span></span><br><span class="line">        <span class="keyword">return</span> Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> minCapacity;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//判断是否需要扩容</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length > <span class="number">0</span>)</span><br><span class="line">        <span class="comment">//调用grow方法进行扩容，调用此方法代表已经开始扩容了</span></span><br><span class="line">        grow(minCapacity);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h5 id="1-1-1-2-扩容"><a href="#1-1-1-2-扩容" class="headerlink" title="1.1.1.2 扩容"></a>1.1.1.2 扩容</h5><ul>
<li><p><code>扩容</code>：如当前数组长度为10，来了第十一个元素，就要就行扩容</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// minCapacity 所需的最小容量</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ensureCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) ? <span class="number">0</span> : DEFAULT_CAPACITY;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity > minExpand) {</span><br><span class="line">        ensureExplicitCapacity(minCapacity);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 判断是否需要扩容</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureExplicitCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length > <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// 扩容的核心方法</span></span><br><span class="line">        grow(minCapacity);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 需要分配的最大数组的大小</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="number">8</span>;</span><br><span class="line"><span class="comment">// ArrayList扩容的核心方法</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="comment">// newCapacity为旧容量oldCapacity的1.5倍，oldCapacity >> 1 等价于 oldCapacity/2</span></span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + (oldCapacity >> <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 新容量小于最小需求量，则最小需求量为数组的新容量</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity < <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="comment">// 新容量是否大于ArrayList所定义的最大容量</span></span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE > <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// minCapacity is usually close to size, so this is a win:</span></span><br><span class="line">    <span class="comment">// 这就是传说中的可变集合。用新长度复制原数组。  </span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 新容量是否大于ArrayList所定义的最大容量时，比较最小需求量和MAX_ARRAY_SIZE</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hugeCapacity</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (minCapacity < <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> OutOfMemoryError();</span><br><span class="line">    <span class="keyword">return</span> (minCapacity > MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h5 id="1-1-1-3-删除元素"><a href="#1-1-1-3-删除元素" class="headerlink" title="1.1.1.3 删除元素"></a>1.1.1.3 删除元素</h5><ul>
<li><p><code>删除该列表中指定位置的元素。 将任何后续元素向左移动一位（从其索引中减去一个元素）。</code></p>
<p><a href="https://img-blog.csdnimg.cn/20190718210144576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190718210144576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{</span><br><span class="line">    rangeCheck(index);</span><br><span class="line"></span><br><span class="line">    modCount++;</span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> numMoved = size - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved > <span class="number">0</span>)</span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    elementData[--size] = <span class="keyword">null</span>; <span class="comment">// clear to let GC do its work</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h5 id="1-1-1-4-copyOf-和arraycopy"><a href="#1-1-1-4-copyOf-和arraycopy" class="headerlink" title="1.1.1.4 copyOf()和arraycopy()"></a>1.1.1.4 copyOf()和arraycopy()</h5><ul>
<li><p><code>Arrays.copyOf()和System.arraycopy():</code></p>
<ul>
<li><p><code>联系</code>：看两者源代码可以发现 copyOf() 内部实际调用了 System.arraycopy()方法 </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <t,u> T[] copyOf(U[] original, <span class="keyword">int</span> newLength, Class<!--? extends T[]--> newType) {</t,u></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    T[] copy = ((Object)newType == (Object)Object[]<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">        ? (T[]) new Object[newLength]</span><br><span class="line">        : (T[]) Array.newInstance(newType.getComponentType(), newLength);</span><br><span class="line">    System.arraycopy(original, <span class="number">0</span>, copy, <span class="number">0</span>,</span><br><span class="line">                     Math.min(original.length, newLength));</span><br><span class="line">    <span class="keyword">return</span> copy;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p><code>区别</code>：<code>arraycopy()</code> 需要目标数组，将原数组拷贝到你自己定义的数组里或者原数组，而且可以选择拷贝的起点和长度以及放入新数组中的位置 。<code>copyOf()</code> 是系统自动在内部新建一个数组，并返回该数组。</p>
</li>
</ul>
</li>
</ul>
<h3 id="1-2-Vector"><a href="#1-2-Vector" class="headerlink" title="1.2 Vector"></a>1.2 Vector</h3><h4 id="1-2-1-类说明"><a href="#1-2-1-类说明" class="headerlink" title="1.2.1 类说明"></a>1.2.1 类说明</h4><ul>
<li><p><code>Vector</code>继承了<code>AbstractList</code>抽象类，实现了<code>List</code>，<code>RandomAccess</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>接口，底层实现也是动态数组，和ArrayList不同的是<code>Vector是线程的</code>，Vector中的很多方法使用synchronized关键字进行了同步加锁操作。这个类现在使用的很少了。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Vector</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractList</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">List</span><<span class="title">E</span>>, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>其他的内容和ArrayList差不多，不再赘述。</p>
</li>
</ul>
<h4 id="1-2-2-内部结构"><a href="#1-2-2-内部结构" class="headerlink" title="1.2.2 内部结构"></a>1.2.2 内部结构</h4><h5 id="1-2-2-1-初始化"><a href="#1-2-2-1-初始化" class="headerlink" title="1.2.2.1 初始化"></a>1.2.2.1 初始化</h5><ul>
<li><p><code>调用Vector的无参构造方法，默认的初始化大小为10</code>：注意ArrayList调用无参的构造方法时并没有分配大小，在第一次add的时候，初始化大小为10，而Vector调用无参的构造方法时，直接初始化数组大小为10，注意区分。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Vector</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>(<span class="number">10</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h5 id="1-2-2-2-扩容"><a href="#1-2-2-2-扩容" class="headerlink" title="1.2.2.2 扩容"></a>1.2.2.2 扩容</h5><ul>
<li><p>Vector的扩容和ArrayList的扩容基本一致</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用add(E e)/add(int index, E element)都会进行是否要扩容的判断，这里仅以add(E e)为例</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>{</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="comment">// 判断是否普需要扩容</span></span><br><span class="line">    ensureCapacityHelper(elementCount + <span class="number">1</span>);</span><br><span class="line">    elementData[elementCount++] = e;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 判断是否需要扩容</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ensureCapacityHelper</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    <span class="comment">// 若最小期望容量比实际的数组容量大，说明数组长度不够，就需要扩容</span></span><br><span class="line">    <span class="keyword">if</span> (minCapacity - elementData.length > <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// 扩容的核心方法</span></span><br><span class="line">        grow(minCapacity);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 扩容</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">grow</span><span class="params">(<span class="keyword">int</span> minCapacity)</span> </span>{</span><br><span class="line">    <span class="comment">// overflow-conscious code</span></span><br><span class="line">    <span class="keyword">int</span> oldCapacity = elementData.length;</span><br><span class="line">    <span class="keyword">int</span> newCapacity = oldCapacity + ((capacityIncrement > <span class="number">0</span>) ?</span><br><span class="line">                                     capacityIncrement : oldCapacity);</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minCapacity < <span class="number">0</span>)</span><br><span class="line">        newCapacity = minCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE > <span class="number">0</span>)</span><br><span class="line">        newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">    <span class="comment">// 将原数组复制到新数组中</span></span><br><span class="line">    elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h5 id="1-2-2-3-删除元素"><a href="#1-2-2-3-删除元素" class="headerlink" title="1.2.2.3 删除元素"></a>1.2.2.3 删除元素</h5><ul>
<li><p>删除元素和ArrayList基本一致</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> E <span class="title">remove</span><span class="params">(<span class="keyword">int</span> index)</span> </span>{</span><br><span class="line">    modCount++;</span><br><span class="line">    <span class="keyword">if</span> (index >= elementCount)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ArrayIndexOutOfBoundsException(index);</span><br><span class="line">    E oldValue = elementData(index);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> numMoved = elementCount - index - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (numMoved > <span class="number">0</span>)</span><br><span class="line">        System.arraycopy(elementData, index+<span class="number">1</span>, elementData, index,</span><br><span class="line">                         numMoved);</span><br><span class="line">    elementData[--elementCount] = <span class="keyword">null</span>; <span class="comment">// Let gc do its work</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> oldValue;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h3 id="1-3-LinkedList"><a href="#1-3-LinkedList" class="headerlink" title="1.3 LinkedList"></a>1.3 LinkedList</h3><h4 id="1-3-1-类说明"><a href="#1-3-1-类说明" class="headerlink" title="1.3.1 类说明"></a>1.3.1 类说明</h4><ul>
<li><p><code>LinkedList</code>是一个继承了<code>AbstractSequentialList抽象类</code>实现了<code>List</code>和<code>Deque</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>的<code>双端链表</code>（双向链表）。 </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedList</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractSequentialList</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">List</span><<span class="title">E</span>>, <span class="title">Deque</span><<span class="title">E</span>>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>LinkedList底层的链表结构(<code>双向链表</code>，长度没有限制，在JDK1.7之前底层为<code>双向循环链表</code>，在JDK1.7的时候去掉了<code>循环</code>，双向循环链表和双向链表的区别就在于首尾节点是否相连)使它<code>支持高效的插入和删除操作</code>，另外它实现了Deque接口(Deque接口继承了Queue接口)，使得LinkedList类也具有队列的特性;</p>
</li>
<li><p>LinkedList<code>不是线程安全的</code>，如果想使LinkedList变成线程安全的，可以调用静态类<code>Collections类</code>中的<code>synchronizedList</code>方法： </p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List list=Collections.synchronizedList(<span class="keyword">new</span> LinkedList(...));</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="1-3-2-内部结构"><a href="#1-3-2-内部结构" class="headerlink" title="1.3.2 内部结构"></a>1.3.2 内部结构</h4><ul>
<li><p>底层是<code>双向链表</code>，如下图：</p>
<p><a href="https://img-blog.csdnimg.cn/20190718210102485.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190718210102485.png" class="lazyload"></a></p>
</li>
<li><p>LinkedList源码中有一个内部私有类，描述了双端链表的节点Node，可知Node包含三个属性：<code>前驱节点</code>，<code>节点值</code>，<code>后继节点</code>，如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span><<span class="title">E</span>> </span>{</span><br><span class="line">    E item;<span class="comment">//节点值</span></span><br><span class="line">    Node<e> next;<span class="comment">//后继节点</span></e></span><br><span class="line">    Node<e> prev;<span class="comment">//前驱节点</span></e></span><br><span class="line">    Node(Node<e> prev, E element, Node<e> next) {</e></e></span><br><span class="line">        <span class="keyword">this</span>.item = element;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">        <span class="keyword">this</span>.prev = prev;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>链表的操作头插啊尾插啊，中间插入啊，删除啊等就不介绍了，都是比较基础的数据结构的知识。</p>
</li>
</ul>
<h2 id="2-Set"><a href="#2-Set" class="headerlink" title="2 Set"></a>2 Set</h2><h3 id="2-1-HashSet"><a href="#2-1-HashSet" class="headerlink" title="2.1 HashSet"></a>2.1 HashSet</h3><h4 id="2-1-1-类说明"><a href="#2-1-1-类说明" class="headerlink" title="2.1.1 类说明"></a>2.1.1 类说明</h4><ul>
<li><p><code>HashSet</code>继承<code>AbstractSet抽象类</code>，实现<code>Set</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>接口。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSet</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractSet</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Set</span><<span class="title">E</span>>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>存放的元素是无序的，不可重复的，它维持它自己的内部排序，所以随机访问没有任何意义。允许存放null值，底层封装<code>HashMap</code>（是基于HashMap实现的，最终依然使用数组存储数据）所以也是不同步的线程不安全的。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 保障线程安全</span></span><br><span class="line">Collections.synchronizedSet(<span class="keyword">new</span> HashSet(...));</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="2-1-2-内部结构"><a href="#2-1-2-内部结构" class="headerlink" title="2.1.2 内部结构"></a>2.1.2 内部结构</h4><ul>
<li><p><code>就是一个元素不重复的HashMap</code>(HashMap的详细介绍在下面)，可以看到HashSet的构造方法是直接new的HashMap。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> HashMap<e,object> map;</e,object></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">()</span> </span>{</span><br><span class="line">    map = <span class="keyword">new</span> HashMap<>();</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(Collection<!--? extends E--> c)</span> </span>{</span><br><span class="line">    map = <span class="keyword">new</span> HashMap<>(Math.max((<span class="keyword">int</span>) (c.size()/.<span class="number">75f</span>) + <span class="number">1</span>, <span class="number">16</span>));</span><br><span class="line">    addAll(c);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>{</span><br><span class="line">    map = <span class="keyword">new</span> HashMap<>(initialCapacity, loadFactor);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>{</span><br><span class="line">    map = <span class="keyword">new</span> HashMap<>(initialCapacity);</span><br><span class="line">}</span><br><span class="line">HashSet(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor, <span class="keyword">boolean</span> dummy) {</span><br><span class="line">    <span class="comment">// 看到LinkedHashMap莫慌，LinkedHashMap的构造也是调用父类HashMap的构造实现的</span></span><br><span class="line">    map = <span class="keyword">new</span> LinkedHashMap<>(initialCapacity, loadFactor);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>那么，是如何保障元素的不重复呢？</p>
<p>很简单，HashMap中的key保障了唯一，使所有的value对应一个内部的对象PRESENT即可。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义value对应的唯一内部对象</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Object PRESENT = <span class="keyword">new</span> Object();</span><br><span class="line"><span class="comment">// HashMap的put方法如果该位置已经存在一个一样的Key（==或者equals相等），会用新的value替换原来的旧的value，并且返回旧的value，所以对于HashSet而言第一次插入返回null就代表成功，以后再次插入同样的元素，返回的是一个对象，表示已经存在这样的元素了，插入失败！</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> map.put(e, PRESENT)==<span class="keyword">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h3 id="2-2-LinkedHashSet"><a href="#2-2-LinkedHashSet" class="headerlink" title="2.2 LinkedHashSet"></a>2.2 LinkedHashSet</h3><h4 id="2-2-1-类说明"><a href="#2-2-1-类说明" class="headerlink" title="2.2.1 类说明"></a>2.2.1 类说明</h4><ul>
<li><p><code>LinkedHashSet</code>继承了<code>HashSet</code>类，实现了<code>Set</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>接口。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedHashSet</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">HashSet</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Set</span><<span class="title">E</span>>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>因为实现了Set接口，所以具有Set集合元素不重复的特点，同时具有可预测的迭代顺序，也就是我们插入的顺序(默认)。</p>
</li>
<li><p>LinkedHashSet源码中的方法非常简单，是基于<code>LinkedHashMap</code>实现的(LinkedHashMap下面有详细的介绍)。</p>
</li>
<li><p>LinkedHashSet是有序的，它是按照插入的顺序排序的。</p>
</li>
</ul>
<h4 id="2-2-2-内部结构"><a href="#2-2-2-内部结构" class="headerlink" title="2.2.2 内部结构"></a>2.2.2 内部结构</h4><h5 id="2-2-2-1-初始化"><a href="#2-2-2-1-初始化" class="headerlink" title="2.2.2.1 初始化"></a>2.2.2.1 初始化</h5><ul>
<li><p>调用LinkedHashSet默认的构造方法(无参)，可以得知，初始化大小为16。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashSet</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(<span class="number">16</span>, .<span class="number">75f</span>, <span class="keyword">true</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>基于<code>LinkedHashMap</code>实现的证据：</p>
<p>打开LinkedHashSet的源码你可能首先会有一点懵逼，因为里面一共就一个静态常量，四个构造方法和一个重写的切分的方法。而且构造方法上是super，也看不出是基于什么父类实现的，如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(initialCapacity, loadFactor, <span class="keyword">true</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashSet</span><span class="params">(<span class="keyword">int</span> initialCapacity)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(initialCapacity, .<span class="number">75f</span>, <span class="keyword">true</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashSet</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(<span class="number">16</span>, .<span class="number">75f</span>, <span class="keyword">true</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashSet</span><span class="params">(Collection<!--? extends E--> c)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(Math.max(<span class="number">2</span>*c.size(), <span class="number">11</span>), .<span class="number">75f</span>, <span class="keyword">true</span>);</span><br><span class="line">    addAll(c);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>但是别慌，按住Ctrl，点进super，你会发现都是基于同一个方法实现的，如下，可以看出，是直接new了一个<code>LinkedHashMap</code>，所以现在知道为什么说是基于LinkedHashMap实现了的不。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashSet(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor, <span class="keyword">boolean</span> dummy) {</span><br><span class="line">    map = <span class="keyword">new</span> LinkedHashMap<>(initialCapacity, loadFactor);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>同时，基于好奇心我又点进了<code>LinkedHashMap</code>，看到了下面的类：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashMap</span><span class="params">(<span class="keyword">int</span> initialCapacity, <span class="keyword">float</span> loadFactor)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(initialCapacity, loadFactor);</span><br><span class="line">    accessOrder = <span class="keyword">false</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>看到了一句很关键的话：<code>accessOrder = false</code>，这里写死了就让accessOrder为false，也就是说，LinkedHashSet是不支持按访问顺序对元素排序的，只能<code>按插入顺序排序</code>。</p>
</li>
<li><p>后面会介绍LinkedHashMap，就不赘述了，好，下一个！</p>
</li>
</ul>
<h3 id="2-3-TreeSet"><a href="#2-3-TreeSet" class="headerlink" title="2.3 TreeSet"></a>2.3 TreeSet</h3><h4 id="2-3-1-类说明"><a href="#2-3-1-类说明" class="headerlink" title="2.3.1 类说明"></a>2.3.1 类说明</h4><ul>
<li><p><code>TreeSet</code>继承了<code>AbstractSet</code>抽象类，实现了<code>NavigableSet</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>接口，就像HashSet是基于HashMap实现的一样，<code>TreeSet是基于TreeMap实现的</code>(后面有TreeMap的介绍)，可以说TreeSet的底层是自平衡的排序二叉树(红黑树)。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeSet</span><<span class="title">E</span>> <span class="keyword">extends</span> <span class="title">AbstractSet</span><<span class="title">E</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">NavigableSet</span><<span class="title">E</span>>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>TreeSet实现了<code>NavigableSet</code>接口，而NavigableSet接口继承<code>SortedSet</code>接口，所以 是一个有序的集合，它的作用是提供有序的Set集合。</p>
</li>
<li><p>TreeSet的元素支持2种排序方式：<code>自然排序</code>或者<code>根据提供的Comparator进行排序</code>。</p>
</li>
</ul>
<h4 id="2-3-2-内部结构"><a href="#2-3-2-内部结构" class="headerlink" title="2.3.2 内部结构"></a>2.3.2 内部结构</h4><ul>
<li>略</li>
</ul>
<h1 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h1><h2 id="1-HashMap"><a href="#1-HashMap" class="headerlink" title="1 HashMap"></a>1 HashMap</h2><h3 id="1-1-类说明"><a href="#1-1-类说明" class="headerlink" title="1.1 类说明"></a>1.1 类说明</h3><ul>
<li><p><code>HashMap</code>继承<code>AbstractMap抽象类</code>，实现<code>Map</code>，<code>Cloneable</code>，<code>Serializable</code>接口，主要用于存放键值对。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashMap</span><<span class="title">K</span>,<span class="title">V</span>> <span class="keyword">extends</span> <span class="title">AbstractMap</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span><<span class="title">K</span>,<span class="title">V</span>>, <span class="title">Cloneable</span>, <span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>在JDK1.8之前的HashMap是由<code>数组+链表</code>组成的，数组是HashMap的主体，链表则是主要为了解决哈希冲突而存在的(<code>拉链法</code>解决冲突)，在JDK1.8之后在解决哈希冲突时有了较大的变化，当链表长度大于阈值(默认是8)时，将链表转化为红黑树，可以减少搜索时间。</p>
</li>
<li><p><code>HashMap是非线程安全的</code>，若要保证线程安全，可以使用 <code>ConcurrentHashMap</code> 。</p>
</li>
<li><p>HashMap可以存储一个Key为null，多个value为null的元素。</p>
</li>
</ul>
<h3 id="1-2-内部结构："><a href="#1-2-内部结构：" class="headerlink" title="1.2 内部结构："></a>1.2 内部结构：</h3><h4 id="1-2-1-初始化"><a href="#1-2-1-初始化" class="headerlink" title="1.2.1 初始化"></a>1.2.1 初始化</h4><ul>
<li><p>先看一下HashMap的无参构造方法，如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs an empty <tt>HashMap</tt> with the default initial capacity</span></span><br><span class="line"><span class="comment"> * (16) and the default load factor (0.75).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>乍一看HashMap的无参构造方法只是简单的指定了哈希表的加载因子，并没有定义初始化容量，但是这个构造方法上面的注释说：<code>初始化容量大小为16</code>，于是找啊找，终于找到了，原来是直接定义了一个常量，默认为16。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1 << 4 :表示1左移4为，即2的4次方，那可不就是16嘛</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> << <span class="number">4</span>;</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="1-2-2-hash-的变化"><a href="#1-2-2-hash-的变化" class="headerlink" title="1.2.2 hash()的变化"></a>1.2.2 hash()的变化</h4><ul>
<li><p><code>hash()：</code>先说一下hash()方法的变化，从下面的代码可以看出，1.8之后的性能更高，毕竟只有一次>>></p>
<p>JDK1.8之前的hash():</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(<span class="keyword">int</span> h)</span> </span>{</span><br><span class="line">    h ^= (h >>> <span class="number">20</span>) ^ (h >>> <span class="number">12</span>);</span><br><span class="line">    <span class="keyword">return</span> h ^ (h >>> <span class="number">7</span>) ^ (h >>> <span class="number">4</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

<p>JDK1.8之后的hash():</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// key.hashCode()返回散列值，即hashcode</span></span><br><span class="line"><span class="comment">// >>>:无符号右移，忽略符号位，空位都以0补齐</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h >>> <span class="number">16</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="1-2-3-存储结构"><a href="#1-2-3-存储结构" class="headerlink" title="1.2.3 存储结构"></a>1.2.3 存储结构</h4><ul>
<li><p>1.8之后的存储结构：<code>数组</code>+<code>链表</code>+<code>红黑树</code>，大致如下图：</p>
<p><a href="https://img-blog.csdnimg.cn/20190718210206305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190718210206305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
</li>
<li><p><code>数组</code>：Node<k,v>[] table，即哈希桶数组，存储了头节点的table数组，HashMap就是使用哈希表实现的：</k,v></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node<k,v>[] table;</k,v></span><br><span class="line"><span class="comment">// 实现了Map.Entry接口，本质上就是一个键值对</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span><<span class="title">K</span>,<span class="title">V</span>> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span><<span class="title">K</span>,<span class="title">V</span>> </span>{</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    Node<k,v> next;</k,v></span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node<k,v> next) {</k,v></span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>{ <span class="keyword">return</span> key; }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>{ <span class="keyword">return</span> value; }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>{ <span class="keyword">return</span> key + <span class="string">"="</span> + value; }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>{</span><br><span class="line">        V oldValue = value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    }</span><br><span class="line">	<span class="comment">// </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) {</span><br><span class="line">            Map.Entry<!--?,?--> e = (Map.Entry<!--?,?-->)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &&</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="1-2-4-put-方法"><a href="#1-2-4-put-方法" class="headerlink" title="1.2.4 put()方法"></a>1.2.4 put()方法</h4><ul>
<li><p>以向HashMap中添加数据为例介绍以下几个操作：<code>插入是在链表的尾部插入</code>。</p>
<p><a href="https://img-blog.csdnimg.cn/20190718210220597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190718210220597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用put()方法</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>{</span><br><span class="line">      <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">// 调用putVal()方法之前调用了hash()，获取key对应的hashcode</span></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>{</span><br><span class="line">      <span class="keyword">int</span> h;</span><br><span class="line">      <span class="comment">// 可以看到 取到hashcode后 和自己本身的高16位做了亦或操作，是为了使hashcode的生成更加散列</span></span><br><span class="line">      <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h >>> <span class="number">16</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">// 接下来调用putVal()方法进行具体的插入数据</span></span><br><span class="line">  <span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent, <span class="keyword">boolean</span> evict)</span> </span>{</span><br><span class="line">      Node<k,v>[] tab; Node<k,v> p; <span class="keyword">int</span> n, i;</k,v></k,v></span><br><span class="line">      <span class="comment">// 判断table是否进行了初始化</span></span><br><span class="line">      <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">          <span class="comment">// table初始化，即扩容</span></span><br><span class="line">          n = (tab = resize()).length;</span><br><span class="line">      <span class="comment">// 将新生成的hashcode和table的长度n-1做&操作，获取该节点在数据中的下标</span></span><br><span class="line">      <span class="comment">// 如果数组中该位置没有数据，则根据传入的值生成新node节点</span></span><br><span class="line">      <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) & hash]) == <span class="keyword">null</span>)</span><br><span class="line">          tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">      <span class="keyword">else</span> { <span class="comment">// 该位置上已经存在其他节点(上面if操作已经对p进行了赋值，为tab[(n-1)&hash])</span></span><br><span class="line">          Node<k,v> e; K k;</k,v></span><br><span class="line">          <span class="comment">// 判断已经存在的节点数据和新传入的节点key和hash值是否相同</span></span><br><span class="line">          <span class="keyword">if</span> (p.hash == hash && ((k = p.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">              e = p;</span><br><span class="line">          <span class="comment">// 判断是否是一个树节点，若是，直接在红黑树中插入键值对</span></span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">              e = ((TreeNode<k,v>)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</k,v></span><br><span class="line">          <span class="keyword">else</span> { <span class="comment">//  已存在节点的key和新增的key不相同，发生hash冲突</span></span><br><span class="line">              <span class="comment">// 将新节点放入该节点链表的最后</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) {</span><br><span class="line">                  <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) { <span class="comment">// 查找到链表的最后一个节点后，进行赋值操作</span></span><br><span class="line">                      p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                      <span class="keyword">if</span> (binCount >= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                          <span class="comment">// 在链表长度超过一定长度时，将链表转红黑树存储</span></span><br><span class="line">                          treeifyBin(tab, hash);</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  }</span><br><span class="line">                  <span class="comment">// 在将新节点放置在链表最后位置后，终止循环</span></span><br><span class="line">                  <span class="keyword">if</span> (e.hash == hash && ((k = e.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  p = e;</span><br><span class="line">              }</span><br><span class="line">          }</span><br><span class="line">          <span class="comment">// 定位到put数据位置，进行value赋值操作</span></span><br><span class="line">          <span class="keyword">if</span> (e != <span class="keyword">null</span>) { <span class="comment">// existing mapping for key</span></span><br><span class="line">              V oldValue = e.value; <span class="comment">// 获取key 对应节点的原来数据</span></span><br><span class="line">              <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                  e.value = value; <span class="comment">// 重新赋值</span></span><br><span class="line">              afterNodeAccess(e);</span><br><span class="line">              <span class="keyword">return</span> oldValue; <span class="comment">// 返回节点原数据</span></span><br><span class="line">          }</span><br><span class="line">      }</span><br><span class="line">      <span class="comment">// 没有发生hash冲突，数组的某个位置被占用，hashMap 结构修改次数 </span></span><br><span class="line">      ++modCount;</span><br><span class="line">      <span class="comment">// 数组已经被占用数量++，自增后判断当前数组是否需要扩容</span></span><br><span class="line">      <span class="keyword">if</span> (++size > threshold)</span><br><span class="line">          resize();</span><br><span class="line">      afterNodeInsertion(evict);<span class="comment">// LinkedHashMap 方法</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="comment">// TreeNode节点</span></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span><<span class="title">K</span>,<span class="title">V</span>> <span class="keyword">extends</span> <span class="title">LinkedHashMap</span>.<span class="title">Entry</span><<span class="title">K</span>,<span class="title">V</span>> </span>{</span><br><span class="line">      TreeNode<k,v> parent;  <span class="comment">// red-black tree links</span></k,v></span><br><span class="line">      TreeNode<k,v> left;</k,v></span><br><span class="line">      TreeNode<k,v> right;</k,v></span><br><span class="line">      TreeNode<k,v> prev;    <span class="comment">// needed to unlink next upon deletion</span></k,v></span><br><span class="line">      <span class="keyword">boolean</span> red;</span><br><span class="line">      TreeNode(<span class="keyword">int</span> hash, K key, V val, Node<k,v> next) {</k,v></span><br><span class="line">          <span class="keyword">super</span>(hash, key, val, next);</span><br><span class="line">      }</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">           * Returns root of tree containing this node.</span></span><br><span class="line"><span class="comment">           */</span></span><br><span class="line">      <span class="function"><span class="keyword">final</span> TreeNode<k,v> <span class="title">root</span><span class="params">()</span> </k,v></span>{</span><br><span class="line">          <span class="keyword">for</span> (TreeNode<k,v> r = <span class="keyword">this</span>, p;;) {</k,v></span><br><span class="line">              <span class="keyword">if</span> ((p = r.parent) == <span class="keyword">null</span>)</span><br><span class="line">                  <span class="keyword">return</span> r;</span><br><span class="line">              r = p;</span><br><span class="line">          }</span><br><span class="line">      }</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure></div>

<h4 id="1-2-5-get-方法"><a href="#1-2-5-get-方法" class="headerlink" title="1.2.5 get()方法"></a>1.2.5 get()方法</h4><ul>
<li><p>那么又是如何获取数据的呢？</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用get()方法，通过key获取</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>{</span><br><span class="line">    Node<k,v> e;</k,v></span><br><span class="line">    <span class="comment">// 计算key对应的hashcode值，去获取节点</span></span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 获取节点</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node<k,v> <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </k,v></span>{</span><br><span class="line">    Node<k,v>[] tab; Node<k,v> first, e; <span class="keyword">int</span> n; K k;</k,v></k,v></span><br><span class="line">    <span class="comment">// 数组不为空，长度部位0并且有元素</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> && (n = tab.length) > <span class="number">0</span> &&</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) & hash]) != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="comment">// 若为第一个元素，直接返回</span></span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash && <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="comment">// 不是第一个元素</span></span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) {</span><br><span class="line">            <span class="comment">// 判断是否为树节点</span></span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="comment">// 若是，直接获取节点并返回</span></span><br><span class="line">                <span class="keyword">return</span> ((TreeNode<k,v>)first).getTreeNode(hash, key);</k,v></span><br><span class="line">            <span class="comment">// 不是树节点的话，遍历下面的节点，匹配则返回</span></span><br><span class="line">            <span class="keyword">do</span> {</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &&</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            } <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 否则，没有这个节点，返回null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 获取树节点，源码就放到这里，不再深入了</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> TreeNode<k,v> <span class="title">getTreeNode</span><span class="params">(<span class="keyword">int</span> h, Object k)</span> </k,v></span>{</span><br><span class="line">    <span class="keyword">return</span> ((parent != <span class="keyword">null</span>) ? root() : <span class="keyword">this</span>).find(h, k, <span class="keyword">null</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h2 id="2-Hashtable"><a href="#2-Hashtable" class="headerlink" title="2 Hashtable"></a>2 Hashtable</h2><h3 id="2-1-类说明"><a href="#2-1-类说明" class="headerlink" title="2.1 类说明"></a>2.1 类说明</h3><ul>
<li><p><code>Hashtable</code>继承了<code>Dictionary抽象类</code>，实现了<code>Map</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>接口，虽然和HashMap同样都属于散列表，但使用的情况很少。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hashtable</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">Dictionary</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span><<span class="title">K</span>,<span class="title">V</span>>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializables</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>唯一一点优于HashMap是：<code>Hashtable是线程安全的</code>。但是想在多线程下使用散列表的话还是建议使用上面说过的<code>ConcurrentHashMap</code>来替换Hashtable。</p>
</li>
<li><p>Hashtable不允许key或者value为null。</p>
</li>
</ul>
<h3 id="2-2-内部结构"><a href="#2-2-内部结构" class="headerlink" title="2.2 内部结构"></a>2.2 内部结构</h3><h4 id="2-2-1-初始化"><a href="#2-2-1-初始化" class="headerlink" title="2.2.1 初始化"></a>2.2.1 初始化</h4><ul>
<li><p><code>初始化（无参构造方法）：Hashtable默认capacity是11，默认负载因子是0.75f。</code></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Hashtable</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>(<span class="number">11</span>, <span class="number">0.75f</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="2-2-2-存储结构"><a href="#2-2-2-存储结构" class="headerlink" title="2.2.2 存储结构"></a>2.2.2 存储结构</h4><ul>
<li><p>Hashtable的底层是：<code>Entry数组</code>+<code>链表实现的</code>，结构如下图：</p>
<p><a href="https://img-blog.csdnimg.cn/20190718210250246.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://img-blog.csdnimg.cn/20190718210250246.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">transient</span> Entry<!--?,?-->[] table;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span><<span class="title">K</span>,<span class="title">V</span>> <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span><<span class="title">K</span>,<span class="title">V</span>> </span>{</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    Entry<k,v> next;</k,v></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">Entry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, Entry<k,v> next)</k,v></span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key =  key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Entry<>(hash, key, value,</span><br><span class="line">                           (next==<span class="keyword">null</span> ? <span class="keyword">null</span> : (Entry<k,v>) next.clone()));</k,v></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Map.Entry Ops</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> K <span class="title">getKey</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">getValue</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> V <span class="title">setValue</span><span class="params">(V value)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line"></span><br><span class="line">        V oldValue = <span class="keyword">this</span>.value;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Map.Entry))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        Map.Entry<!--?,?--> e = (Map.Entry<!--?,?-->)o;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (key==<span class="keyword">null</span> ? e.getKey()==<span class="keyword">null</span> : key.equals(e.getKey())) &&</span><br><span class="line">            (value==<span class="keyword">null</span> ? e.getValue()==<span class="keyword">null</span> : value.equals(e.getValue()));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> hash ^ Objects.hashCode(value);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> key.toString()+<span class="string">"="</span>+value.toString();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="2-2-3-put-方法"><a href="#2-2-3-put-方法" class="headerlink" title="2.2.3 put()方法"></a>2.2.3 put()方法</h4><ul>
<li><p>与HashMap不同的是这里会对value进行是否为空的校验，节点为Entry节点，没有红黑树（看着很像JDK1.8之前的HashMap）</p>
</li>
<li><p>并且<code>HashMap</code>是<code>在链表的尾部插入元素</code>，而<code>Hashtable</code>是<code>在链表的头部插入元素</code>，可能是因为没有HashMap的红黑树机制，如果要在尾部添加元素的话可能需要遍历大量的数据(链表的长度没有限制)。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>{</span><br><span class="line">    <span class="comment">// Make sure the value is not null</span></span><br><span class="line">    <span class="keyword">if</span> (value == <span class="keyword">null</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// Makes sure the key is not already in the hashtable.</span></span><br><span class="line">    Entry<!--?,?--> tab[] = table;</span><br><span class="line">    <span class="keyword">int</span> hash = key.hashCode();</span><br><span class="line">    <span class="keyword">int</span> index = (hash & <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    Entry<k,v> entry = (Entry<k,v>)tab[index];</k,v></k,v></span><br><span class="line">    <span class="keyword">for</span>(; entry != <span class="keyword">null</span> ; entry = entry.next) {</span><br><span class="line">        <span class="keyword">if</span> ((entry.hash == hash) && entry.key.equals(key)) {</span><br><span class="line">            V old = entry.value;</span><br><span class="line">            entry.value = value;</span><br><span class="line">            <span class="keyword">return</span> old;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    addEntry(hash, key, value, index);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addEntry</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">int</span> index)</span> </span>{</span><br><span class="line">    modCount++;</span><br><span class="line"></span><br><span class="line">    Entry<!--?,?--> tab[] = table;</span><br><span class="line">    <span class="keyword">if</span> (count >= threshold) {</span><br><span class="line">        <span class="comment">// Rehash the table if the threshold is exceeded</span></span><br><span class="line">        rehash();</span><br><span class="line"></span><br><span class="line">        tab = table;</span><br><span class="line">        hash = key.hashCode();</span><br><span class="line">        index = (hash & <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Creates the new entry.</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">    Entry<k,v> e = (Entry<k,v>) tab[index];</k,v></k,v></span><br><span class="line">    tab[index] = <span class="keyword">new</span> Entry<>(hash, key, value, e);</span><br><span class="line">    count++;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="2-2-4-get-方法"><a href="#2-2-4-get-方法" class="headerlink" title="2.2.4 get()方法"></a>2.2.4 get()方法</h4><ul>
<li><p>根据key获取数据的方法如下，是线程安全的：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>{</span><br><span class="line">    <span class="comment">// 获得hashtable数组</span></span><br><span class="line">    Entry<!--?,?--> tab[] = table;</span><br><span class="line">    <span class="comment">// 获得key对应的hashcode</span></span><br><span class="line">    <span class="keyword">int</span> hash = key.hashCode();</span><br><span class="line">    <span class="comment">// 根据当前key的hashcode计算出在hashtable数组中对应的下标</span></span><br><span class="line">    <span class="keyword">int</span> index = (hash & <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    <span class="comment">// 获取对应的链表，遍历找到匹配的hash取值返回</span></span><br><span class="line">    <span class="keyword">for</span> (Entry<!--?,?--> e = tab[index] ; e != <span class="keyword">null</span> ; e = e.next) {</span><br><span class="line">        <span class="keyword">if</span> ((e.hash == hash) && e.key.equals(key)) {</span><br><span class="line">            <span class="keyword">return</span> (V)e.value;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 否则返回null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h2 id="3-LinkedHashMap"><a href="#3-LinkedHashMap" class="headerlink" title="3 LinkedHashMap"></a>3 LinkedHashMap</h2><h3 id="3-1-类说明"><a href="#3-1-类说明" class="headerlink" title="3.1 类说明"></a>3.1 类说明</h3><ul>
<li><p><code>LinkedHashMap</code>继承了<code>HashMap</code>类，实现了<code>Map</code>接口。可以说LinkedHashMap<code>是基于HashMap和双向链表来实现的</code>。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedHashMap</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">HashMap</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">Map</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>LinkedHashMap是线程不安全的。</p>
</li>
<li><p>我们知道HashMap是无序的，内部是<code>数组</code>+<code>单链表</code>，而LinkedHashMap由于底层是<code>数组</code>+<code>双向链表</code>，从而保障了LinkedHashMap是有序的，且默认为插入顺序(无参构造默认accessOrder = false)。</p>
</li>
</ul>
<h3 id="3-2-内部结构"><a href="#3-2-内部结构" class="headerlink" title="3.2 内部结构"></a>3.2 内部结构</h3><h4 id="3-2-1-初始化"><a href="#3-2-1-初始化" class="headerlink" title="3.2.1 初始化"></a>3.2.1 初始化</h4><ul>
<li><p><code>LinkedHashMap</code>使用父类的构造方法初始化，我们在上面说过，其父类<code>HashMap</code>调用无参的构造方法进行初始化的时候，默认的初始化大小为<code>16</code>，那么LinkedHashMap调用无参方法进行初始化的时候的初始大小也是<code>16</code>。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">LinkedHashMap</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line">    <span class="comment">// true表示访问顺序，false表示插入顺序</span></span><br><span class="line">    accessOrder = <span class="keyword">false</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs an empty <tt>HashMap</tt> with the default initial capacity</span></span><br><span class="line"><span class="comment"> * (16) and the default load factor (0.75).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> << <span class="number">4</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="number">0.75f</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">// 多了一个前驱后继的Entry</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Entry</span><<span class="title">K</span>,<span class="title">V</span>> <span class="keyword">extends</span> <span class="title">HashMap</span>.<span class="title">Node</span><<span class="title">K</span>,<span class="title">V</span>> </span>{</span><br><span class="line">    Entry<k,v> before, after;</k,v></span><br><span class="line">    Entry(<span class="keyword">int</span> hash, K key, V value, Node<k,v> next) {</k,v></span><br><span class="line">        <span class="keyword">super</span>(hash, key, value, next);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>上面的初始化过程可用下面的图表示：</p>
<p><a href="https://img-blog.csdnimg.cn/20190720184948456.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190720184948456.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
</li>
</ul>
<h4 id="3-2-2-存储结构："><a href="#3-2-2-存储结构：" class="headerlink" title="3.2.2 存储结构："></a>3.2.2 存储结构：</h4><ul>
<li><p>先看一下HashMap的存储结构：</p>
<p><a href="https://img-blog.csdnimg.cn/20190720184959568.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190720184959568.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
</li>
<li><p>再看一下LinkedHashMap的存储结构对比一下区别：</p>
<p><a href="https://img-blog.csdnimg.cn/20190720185012746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" target="_blank" rel="noopener" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20190720185012746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0RlYXJfVVU=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
</li>
</ul>
<h4 id="3-2-3-put-方法"><a href="#3-2-3-put-方法" class="headerlink" title="3.2.3 put()方法"></a>3.2.3 put()方法</h4><ul>
<li><p>LinkedHashMap并没有重写自己的put()方法，而是直接调用父类HashMap中的put方法，只是重写了newNode()方法，代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父类HashMap中的方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 父类HashMap中的方法</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent, <span class="keyword">boolean</span> evict)</span> </span>{</span><br><span class="line">    Node<k,v>[] tab; Node<k,v> p; <span class="keyword">int</span> n, i;</k,v></k,v></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) & hash]) == <span class="keyword">null</span>)</span><br><span class="line">        <span class="comment">// LinkedHashMap中重写了newNode()方法</span></span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="keyword">else</span> {</span><br><span class="line">        Node<k,v> e; K k;</k,v></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash && ((k = p.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">            e = p;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode<k,v>)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</k,v></span><br><span class="line">        <span class="keyword">else</span> { </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) {</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) {</span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (binCount >= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash && ((k = e.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) { <span class="comment">// existing mapping for key</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value; </span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue; </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="keyword">if</span> (++size > threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);<span class="comment">// LinkedHashMap 方法</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 父类HashMap中的newNode()方法</span></span><br><span class="line"><span class="function">Node<k,v> <span class="title">newNode</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, Node<k,v> next)</k,v></span> </k,v></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Node<>(hash, key, value, next);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// LinkedHashMap中重写了此方法</span></span><br><span class="line"><span class="function">Node<k,v> <span class="title">newNode</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, Node<k,v> e)</k,v></span> </k,v></span>{</span><br><span class="line">    LinkedHashMap.Entry<k,v> p =</k,v></span><br><span class="line">        <span class="keyword">new</span> LinkedHashMap.Entry<k,v>(hash, key, value, e);</k,v></span><br><span class="line">    linkNodeLast(p);</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// LinkedHashMap中实现</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">linkNodeLast</span><span class="params">(LinkedHashMap.Entry<k,v> p)</k,v></span> </span>{</span><br><span class="line">    LinkedHashMap.Entry<k,v> last = tail;</k,v></span><br><span class="line">    tail = p;</span><br><span class="line">    <span class="keyword">if</span> (last == <span class="keyword">null</span>)</span><br><span class="line">        head = p;</span><br><span class="line">    <span class="keyword">else</span> {</span><br><span class="line">        <span class="comment">// 将新节点 p 接在链表尾部</span></span><br><span class="line">        p.before = last;</span><br><span class="line">        last.after = p;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h4 id="3-2-4-get-方法"><a href="#3-2-4-get-方法" class="headerlink" title="3.2.4 get()方法"></a>3.2.4 get()方法</h4><ul>
<li><p>LinkedHashMap重写了get方法，默认是按照插入顺序查询</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// LinkedHashMap 中覆盖</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>{</span><br><span class="line">    Node<k,v> e;</k,v></span><br><span class="line">    <span class="comment">// 默认是按照插入顺序查询的</span></span><br><span class="line">    <span class="keyword">if</span> ((e = getNode(hash(key), key)) == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// 如果为true表示按照访问顺序查询</span></span><br><span class="line">    <span class="keyword">if</span> (accessOrder)</span><br><span class="line">        afterNodeAccess(e);</span><br><span class="line">    <span class="keyword">return</span> e.value;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 父类HashMap中的方法</span></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node<k,v> <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </k,v></span>{</span><br><span class="line">    Node<k,v>[] tab; Node<k,v> first, e; <span class="keyword">int</span> n; K k;</k,v></k,v></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> && (n = tab.length) > <span class="number">0</span> &&</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) & hash]) != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash && <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode<k,v>)first).getTreeNode(hash, key);</k,v></span><br><span class="line">            <span class="keyword">do</span> {</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &&</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> && key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            } <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// LinkedHashMap中覆盖 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">afterNodeAccess</span><span class="params">(Node<k,v> e)</k,v></span> </span>{ <span class="comment">// move node to last</span></span><br><span class="line">    LinkedHashMap.Entry<k,v> last;</k,v></span><br><span class="line">    <span class="keyword">if</span> (accessOrder && (last = tail) != e) {</span><br><span class="line">        LinkedHashMap.Entry<k,v> p =</k,v></span><br><span class="line">            (LinkedHashMap.Entry<k,v>)e, b = p.before, a = p.after;</k,v></span><br><span class="line">        p.after = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="keyword">null</span>)</span><br><span class="line">            head = a;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            b.after = a;</span><br><span class="line">        <span class="keyword">if</span> (a != <span class="keyword">null</span>)</span><br><span class="line">            a.before = b;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            last = b;</span><br><span class="line">        <span class="keyword">if</span> (last == <span class="keyword">null</span>)</span><br><span class="line">            head = p;</span><br><span class="line">        <span class="keyword">else</span> {</span><br><span class="line">            p.before = last;</span><br><span class="line">            last.after = p;</span><br><span class="line">        }</span><br><span class="line">        tail = p;</span><br><span class="line">        ++modCount;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></div>

</li>
</ul>
<h2 id="4-TreeMap"><a href="#4-TreeMap" class="headerlink" title="4 TreeMap"></a>4 TreeMap</h2><h3 id="4-1-类结构"><a href="#4-1-类结构" class="headerlink" title="4.1 类结构"></a>4.1 类结构</h3><ul>
<li><p><code>TreeMap</code>继承了<code>AbstractMap</code>抽象类，实现了<code>NavigableMap</code>，<code>Cloneable</code>，<code>java.io.Serializable</code>接口。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeMap</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractMap</span><<span class="title">K</span>,<span class="title">V</span>></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">NavigableMap</span><<span class="title">K</span>,<span class="title">V</span>>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span></span></span><br></pre></td></tr></tbody></table></figure></div>
</li>
<li><p>是一个有序的，非同步的，基于红黑树实现，该映射根据<code>其键的自然顺序进行排序</code>，或者根据<code>创建映射时提供的 Comparator 进行排序</code>，具体取决于使用的构造方法。</p>
</li>
</ul>
<h3 id="4-2-内部结构"><a href="#4-2-内部结构" class="headerlink" title="4.2 内部结构"></a>4.2 内部结构</h3><ul>
<li>略</li>
</ul>
</body></html></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">XiaoMing</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://xiaoming0929.github.io/2020/04/02/%E9%9B%86%E5%90%88%E5%A4%A7%E6%9D%82%E7%83%A9/">https://xiaoming0929.github.io/2020/04/02/%E9%9B%86%E5%90%88%E5%A4%A7%E6%9D%82%E7%83%A9/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://XiaoMing0929.github.io">XiaoMing's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java    </a><a class="post-meta__tags" href="/tags/%E9%9B%86%E5%90%88/">集合    </a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/03/15/Jbq5kQYoRwiAjp7.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/04/02/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0C3P0%E8%BF%9E%E6%8E%A5%E6%B1%A0-mysql/"><img class="prev_cover lazyload" data-src="https://i.loli.net/2020/03/15/c1J8rCvftZPiqVy.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>数据库连接池C3P0连接池(mysql)</span></div></a></div><div class="next-post pull_right"><a href="/2020/04/02/SSM-Shiro%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><img class="next_cover lazyload" data-src="https://i.loli.net/2020/03/15/os7tu9STUCWx6Qe.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>SSM-Shiro的简单使用</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/02/JVM内存逃逸/" title="JVM内存逃逸"><img class="relatedPosts_cover lazyload"data-src="https://i.loli.net/2020/03/15/os7tu9STUCWx6Qe.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-02</div><div class="relatedPosts_title">JVM内存逃逸</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/02/JVM架构/" title="JVM架构"><img class="relatedPosts_cover lazyload"data-src="https://i.loli.net/2020/03/15/c1J8rCvftZPiqVy.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-02</div><div class="relatedPosts_title">JVM架构</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" style="background-image: url(https://i.loli.net/2020/03/15/Jbq5kQYoRwiAjp7.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By XiaoMing</div><div class="footer_custom_text">一只积极向上的小妖怪。</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>